<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Mini-d√©fis Physique-Chimie Interactifs</title>
  <style>
    :root{
      --bg:#08101f; --card:#14213d; --accent:#00d4ff; --muted:#cbd5e1;
      --success:#4ade80; --error:#f87171;
    }
    *{box-sizing:border-box;scroll-behavior:smooth}
    body{
      font-family:'Poppins', system-ui, sans-serif;
      margin:0; background:radial-gradient(circle at top,#0a192f 0%, #020617 100%);
      color:#f1f5f9; padding:40px 20px; min-height:100vh;
    }
    .container{max-width:960px;margin:auto}
    header{text-align:center;margin-bottom:32px}
    h1{font-size:2.2rem;color:var(--accent);text-shadow:0 0 8px rgba(0,212,255,0.45);margin-bottom:8px}
    p{color:var(--muted);font-size:1.02rem}

    .card{background:linear-gradient(145deg, rgba(255,255,255,0.05), rgba(0,0,0,0.28));
          padding:24px;border-radius:14px;box-shadow:0 0 20px rgba(0,212,255,0.12);}

    .controls{display:flex;gap:12px;justify-content:center;margin-bottom:16px;flex-wrap:wrap}
    button{border:none;border-radius:10px;padding:10px 16px;cursor:pointer;font-weight:600}
    .primary{background:linear-gradient(90deg,var(--accent),#38bdf8);color:#08101f}
    .ghost{background:transparent;border:2px solid var(--accent);color:var(--accent)}

    .progress{height:16px;background:rgba(255,255,255,0.12);border-radius:999px;overflow:hidden;margin-bottom:18px}
    .progress-bar{height:100%;background:linear-gradient(90deg,var(--accent),var(--success));width:0%;transition:width .4s ease}

    .list{display:block}
    .item{background:rgba(255,255,255,0.06);padding:14px;border-radius:10px;margin-bottom:12px}
    .question{font-weight:700;color:var(--accent);margin-bottom:8px}
    input[type=text]{width:100%;padding:10px;border-radius:8px;border:none;background:#1e293b;color:#f1f5f9;margin-bottom:8px}
    .feedback{font-size:0.95rem}
    .correct{color:var(--success);font-weight:700}
    .incorrect{color:var(--error);font-weight:700}

    #certButton {
      display:none;
      margin:20px auto 0;
      padding:12px 20px;
      background:linear-gradient(90deg,var(--success),#16a34a);
      color:#0f172a;
      border:none;
      border-radius:10px;
      cursor:pointer;
      font-weight:700;
      font-size:1rem;
      box-shadow:0 0 10px rgba(34,197,94,0.5);
    }
    #certButton:hover {
      transform:scale(1.05);
      transition:transform 0.2s;
    }

    .meta{display:flex;justify-content:space-between;gap:12px;color:var(--muted);font-size:0.95rem;margin-top:12px}
    @media (max-width:680px){ .meta{flex-direction:column;align-items:center} }
  </style>
</head>
<body>
  <div class="container">
    <header>
      <h1>üî¨ Mini-d√©fis Physique-Chimie</h1>
      <p>R√©ponds aux questions pour d√©bloquer ton certificat de r√©ussite.</p>
    </header>

    <div class="card">
      <div class="controls">
        <button id="dailyBtn" class="primary">Quotidiens</button>
        <button id="weeklyBtn" class="ghost">Hebdomadaires</button>
        <button id="resetBtn" class="ghost">R√©initialiser</button>
      </div>

      <div class="progress">
        <div class="progress-bar" id="progressBar"></div>
      </div>

      <div class="meta">
        <div>Mode : <strong id="modeLabel">Quotidien</strong></div>
        <div>Compl√©t√© : <strong id="doneLabel">0</strong>/<span id="totalLabel">0</span></div>
      </div>

      <div class="list" id="challengeList"></div>

      <button id="certButton">üèÖ T√©l√©charger mon certificat</button>
    </div>
  </div>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

  <script>
 /************************************************************************
   * Donn√©es : chaque question a maintenant un id unique -> suivi stable
   ************************************************************************/
  const challengesData = {
    daily: [
      {id:'d1', question:"Quelle est la formule de la vitesse moyenne ?", answer:"v=d/t"},
      {id:'d2', question:"Quelle est la charge de l'√©lectron ? (en coulombs)", answer:"-1.6e-19"},
      {id:'d3', question:"Quelle est la formule chimique de l'eau ?", answer:"h2o"},
      {id:'d4', question:"Quel est le symbole chimique du sodium ?", answer:"na"},
      {id:'d5', question:"Que mesure une balance ?", answer:"la masse"},
      {id:'d6', question:"Quelle unit√© utilise-t-on pour l‚Äô√©nergie ?", answer:"joule"},
      {id:'d7', question:"Quel est l'√©tat de la mati√®re le plus dense ?", answer:"solide"},
      {id:'d8', question:"Quelle est la formule de la pression ?", answer:"p=f/s"},
      {id:'d9', question:"Quel est le symbole chimique de l'oxyg√®ne ?", answer:"o"},
      {id:'d10', question:"Quelle unit√© mesure la puissance ?", answer:"watt"},
      {id:'d11', question:"Comment s'appelle le changement de liquide √† gaz ?", answer:"vaporisation"},
      {id:'d12', question:"Quelle particule a une charge positive ?", answer:"proton"},
      {id:'d13', question:"Quelle est la formule de l'√©nergie cin√©tique ?", answer:"ec=1/2mv^2"},
      {id:'d14', question:"Quel appareil mesure la tension √©lectrique ?", answer:"voltm√®tre"},
      {id:'d15', question:"Quelle est la formule chimique du m√©thane ?", answer:"ch4"},
      {id:'d16', question:"Comment s'appelle le passage de gaz √† liquide ?", answer:"liqu√©faction"},
      {id:'d17', question:"Quelle est l‚Äôunit√© de la fr√©quence ?", answer:"hertz"},
      {id:'d18', question:"Quel type de liaison relie les atomes dans une mol√©cule d‚Äôeau ?", answer:"liaison covalente"},
      {id:'d19', question:"Quelle est la formule du travail ?", answer:"w=f√ód"},
      {id:'d20', question:"Quel gaz est essentiel √† la respiration ?", answer:"oxyg√®ne"}
    ],
    weekly: [
      {id:'w1', question:"Quelle loi relie la tension, l'intensit√© et la r√©sistance ?", answer:"u=ri"},
      {id:'w2', question:"Quelle est la formule du dioxyde de carbone ?", answer:"co2"},
      {id:'w3', question:"Comment s'appelle le passage de l'√©tat solide √† l'√©tat gazeux ?", answer:"sublimation"},
      {id:'w4', question:"Quelle est la valeur de la gravit√© sur Terre (approx.) ?", answer:"9.8"},
      {id:'w5', question:"Quelle est la formule de la densit√© ?", answer:"œÅ=m/v"},
      {id:'w6', question:"Quelle grandeur se mesure en newtons ?", answer:"force"},
      {id:'w7', question:"Quelle est la formule de la loi des gaz parfaits ?", answer:"pv=nrt"},
      {id:'w8', question:"Quelle particule se trouve dans le noyau d‚Äôun atome ?", answer:"proton"},
      {id:'w9', question:"Quelle est la formule de l‚Äô√©nergie potentielle ?", answer:"ep=mgh"},
      {id:'w10', question:"Quelle est la vitesse de la lumi√®re dans le vide ?", answer:"3e8"},
      {id:'w11', question:"Quel est le symbole chimique du fer ?", answer:"fe"},
      {id:'w12', question:"Comment s‚Äôappelle le processus de s√©paration par diff√©rence d'√©bullition ?", answer:"distillation"},
      {id:'w13', question:"Quelle grandeur est mesur√©e en ohms ?", answer:"r√©sistance"},
      {id:'w14', question:"Quel est le pH d‚Äôune solution neutre ?", answer:"7"},
      {id:'w15', question:"Quelle loi d√©crit la r√©flexion de la lumi√®re ?", answer:"loi de descartes"},
      {id:'w16', question:"Quelle est la formule chimique de l‚Äôammoniac ?", answer:"nh3"},
      {id:'w17', question:"Quel type de r√©action lib√®re de l‚Äô√©nergie ?", answer:"exothermique"},
      {id:'w18', question:"Quel est le nom du point o√π un corps change d‚Äô√©tat solide √† liquide ?", answer:"point de fusion"},
      {id:'w19', question:"Quelle est la formule de la puissance √©lectrique ?", answer:"p=u√ói"},
      {id:'w20', question:"Comment s‚Äôappelle la transformation d‚Äôun liquide en solide ?", answer:"solidification"}
    ]
  };


  const STORAGE_KEY = 'pc_progress';
  let progress = JSON.parse(localStorage.getItem(STORAGE_KEY)) || { daily:{}, weekly:{} };
  const listEl = document.getElementById('challengeList');
  const progressBar = document.getElementById('progressBar');
  const modeLabel = document.getElementById('modeLabel');
  const doneLabel = document.getElementById('doneLabel');
  const totalLabel = document.getElementById('totalLabel');
  const certButton = document.getElementById('certButton');
  let mode = 'daily';

  function normalize(s){return s.toLowerCase().trim().replace(/\s+/g,'');}
  function shuffle(a){return a.sort(()=>Math.random()-0.5);}
  function saveProgress(){localStorage.setItem(STORAGE_KEY,JSON.stringify(progress));}

  function render(){
    const total = challengesData[mode].length;
    const done = Object.keys(progress[mode]).length;
    const pct = Math.round(done/total*100);
    progressBar.style.width = pct + '%';
    modeLabel.textContent = mode==='daily'?'Quotidien':'Hebdomadaire';
    doneLabel.textContent = done;
    totalLabel.textContent = total;
    listEl.innerHTML='';
    shuffle(challengesData[mode]).forEach(q=>{
      const div=document.createElement('div');div.className='item';
      const doneQ = progress[mode][q.id];
      div.innerHTML=`
        <div class="question">${q.question}</div>
        <input type="text" id="input_${q.id}" ${doneQ?'disabled':''}>
        <button class="ghost" data-id="${q.id}" ${doneQ?'disabled':''}>Valider</button>
        <div class="feedback" id="fb_${q.id}">${doneQ?'‚úÖ Correct':''}</div>`;
      listEl.appendChild(div);
    });
    updateCertButton();
  }

  listEl.addEventListener('click',e=>{
    const btn=e.target.closest('button[data-id]');
    if(!btn)return;
    const id=btn.dataset.id;
    const q=challengesData[mode].find(x=>x.id===id);
    const val=normalize(document.getElementById('input_'+id).value);
    if(val===normalize(q.answer)){
      progress[mode][id]=true;saveProgress();
      document.getElementById('fb_'+id).textContent='‚úÖ Correct';
      btn.disabled=true;document.getElementById('input_'+id).disabled=true;
      render();
    }else{
      document.getElementById('fb_'+id).textContent='‚ùå Mauvaise r√©ponse';
    }
  });

  document.getElementById('dailyBtn').onclick=()=>{mode='daily';render();}
  document.getElementById('weeklyBtn').onclick=()=>{mode='weekly';render();}
  document.getElementById('resetBtn').onclick=()=>{
    if(confirm('R√©initialiser toutes les r√©ponses ?')){
      progress={daily:{},weekly:{}};saveProgress();render();certButton.style.display='none';
    }
  };

  function allDone(){
    return Object.keys(progress.daily).length===challengesData.daily.length &&
           Object.keys(progress.weekly).length===challengesData.weekly.length;
  }

  function updateCertButton(){
    certButton.style.display = allDone() ? 'block' : 'none';
  }

  certButton.onclick = generateCertificate;

  function generateCertificate(){
    const { jsPDF } = window.jspdf;
    const doc = new jsPDF({orientation:'landscape'});
    const nom = prompt("Entrez votre nom pour le certificat :") || "√âtudiant";
    doc.setFontSize(24);
    doc.text("Certificat de R√©ussite ‚Äî Physique-Chimie", 30, 50);
    doc.setFontSize(16);
    doc.text(`D√©cern√© √† : ${nom}`, 30, 80);
    doc.text("A compl√©t√© tous les mini-d√©fis quotidiens et hebdomadaires.", 30, 100);
    doc.text("Date : " + new Date().toLocaleDateString('fr-FR'), 30, 120);
    doc.save(`Certificat_${nom.replace(/\s+/g,'_')}.pdf`);
  }

  render();
  </script>
</body>
</html>
